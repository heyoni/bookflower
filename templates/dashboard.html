{% extends 'base/base.html' %}

{% block title %}ëŒ€ì‹œë³´ë“œ - ì±…ë°”ë¼ê¸°{% endblock %}

{% block content %}
<div class="px-4 py-6 space-y-6">

    <!-- Welcome Section -->
    <div class="text-center">
        <h2 class="text-2xl font-bold text-gray-800 mb-2">
            {% if user.is_authenticated %}{{ user.username }}ë‹˜, ì•ˆë…•í•˜ì„¸ìš”! ğŸŒ»{% else %}ì•ˆë…•í•˜ì„¸ìš”! ğŸŒ»{% endif %}
        </h2>
        <p class="text-gray-600">ì˜¤ëŠ˜ë„ ì±…ê³¼ í•¨ê»˜ í•´ë°”ë¼ê¸°ë¥¼ í‚¤ì›Œë³´ì„¸ìš”</p>
    </div>

    {% if user.is_authenticated %}
    <!-- Sunflower Growth Card -->
    <div class="mobile-card sunflower-gradient p-6">
        <div class="text-center">
            <h3 class="text-lg font-bold text-yellow-900 mb-4 flex items-center justify-center">
                <span class="mr-2">ğŸŒ»</span>ë‚´ í•´ë°”ë¼ê¸°
            </h3>

            <!-- Sunflower Stage -->
            <div class="mb-6">
                {% if user.points < 100 %}
                    <div class="text-6xl mb-2">ğŸŒ±</div>
                    <p class="text-yellow-800 font-medium">ìƒˆì‹¹ ë‹¨ê³„</p>
                {% elif user.points < 500 %}
                    <div class="text-6xl mb-2">ğŸŒ¿</div>
                    <p class="text-yellow-800 font-medium">ì„±ì¥ ë‹¨ê³„</p>
                {% elif user.points < 1000 %}
                    <div class="text-6xl mb-2">ğŸŒ»</div>
                    <p class="text-yellow-800 font-medium">ê½ƒ ë‹¨ê³„</p>
                {% else %}
                    <div class="text-6xl mb-2">ğŸŒ»âœ¨</div>
                    <p class="text-yellow-800 font-medium">ë§Œê°œ ë‹¨ê³„</p>
                {% endif %}
            </div>

            <!-- Points Display -->
            <div class="bg-white/30 rounded-2xl p-4 mb-4">
                <div class="flex justify-between items-center mb-3">
                    <span class="text-yellow-900 font-medium">í˜„ì¬ í¬ì¸íŠ¸</span>
                    <span class="text-xl font-bold text-yellow-900">{{ user.points }}P</span>
                </div>
                <div class="w-full bg-white/50 rounded-full h-2">
                    {% if user.points < 100 %}
                        <div class="leaf-gradient h-2 rounded-full transition-all duration-500" style="width: {{ user.points }}%"></div>
                    {% elif user.points < 500 %}
                        <div class="leaf-gradient h-2 rounded-full transition-all duration-500" style="width: {% widthratio user.points 500 100 %}%"></div>
                    {% elif user.points < 1000 %}
                        <div class="leaf-gradient h-2 rounded-full transition-all duration-500" style="width: {% widthratio user.points 1000 100 %}%"></div>
                    {% else %}
                        <div class="leaf-gradient h-2 rounded-full transition-all duration-500" style="width: 100%"></div>
                    {% endif %}
                </div>
                <p class="text-sm text-yellow-800 mt-2 text-center">í•´ë°”ë¼ê¸°ê°€ ìë¼ê³  ìˆì–´ìš”!</p>
            </div>
        </div>
    </div>

    <!-- Stats Cards -->
    <div class="grid grid-cols-2 gap-4">
        <div class="mobile-card bg-white p-4">
            <div class="text-center">
                <div class="text-2xl mb-2">ğŸ“š</div>
                <div class="text-2xl font-bold text-green-600">{{ reading_sessions_count }}</div>
                <div class="text-sm text-gray-600">ë…ì„œ ê¸°ë¡</div>
            </div>
        </div>

        <div class="mobile-card bg-white p-4">
            <div class="text-center">
                <div class="text-2xl mb-2">ğŸ“</div>
                <div class="text-2xl font-bold text-blue-600">{{ notes_count }}</div>
                <div class="text-sm text-gray-600">ì‘ì„±í•œ ë…¸íŠ¸</div>
            </div>
        </div>
    </div>

    <!-- Quick Actions -->
    <div class="space-y-3">
        <h3 class="text-lg font-bold text-gray-800">ë¹ ë¥¸ ì‹¤í–‰</h3>

        <div class="grid grid-cols-2 gap-3">
            <a href="/books/search/" class="mobile-card bg-white p-4 text-center hover:bg-gray-50 transition-colors touch-target">
                <div class="text-3xl mb-2">ğŸ”</div>
                <h4 class="font-bold text-gray-800 text-sm">ì±… ê²€ìƒ‰</h4>
            </a>

            <a href="/reading/start/" class="mobile-card bg-white p-4 text-center hover:bg-gray-50 transition-colors touch-target">
                <div class="text-3xl mb-2">ğŸ“–</div>
                <h4 class="font-bold text-gray-800 text-sm">ë…ì„œ ê¸°ë¡</h4>
            </a>
        </div>

        <div class="grid grid-cols-2 gap-3">
            <a href="/reading/notes/" class="mobile-card bg-white p-4 text-center hover:bg-gray-50 transition-colors touch-target">
                <div class="text-3xl mb-2">ğŸ“</div>
                <h4 class="font-bold text-gray-800 text-sm">ë‚´ ë…¸íŠ¸</h4>
            </a>

            <a href="/reviews/" class="mobile-card bg-white p-4 text-center hover:bg-gray-50 transition-colors touch-target">
                <div class="text-3xl mb-2">ğŸ¤–</div>
                <h4 class="font-bold text-gray-800 text-sm">AI ë…í›„ê°</h4>
            </a>
        </div>
    </div>

    <!-- Recent Activity -->
    {% if recent_sessions %}
    <div class="mobile-card bg-white p-4">
        <h3 class="text-lg font-bold text-gray-800 mb-4 flex items-center">
            <span class="mr-2">ğŸ“–</span>ìµœê·¼ í™œë™
        </h3>
        <div class="space-y-3">
            {% for session in recent_sessions %}
            <div class="flex items-center p-3 bg-gray-50 rounded-xl">
                <div class="w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center mr-3 flex-shrink-0">
                    <span class="text-lg">ğŸ“š</span>
                </div>
                <div class="flex-1 min-w-0">
                    <h4 class="font-medium text-gray-800 text-sm truncate">{{ session.book.title }}</h4>
                    <p class="text-xs text-gray-600">{{ session.created_at|date:"m/d" }} Â· {{ session.pages_read }}í˜ì´ì§€</p>
                </div>
                <span class="text-green-600 font-bold text-sm flex-shrink-0">+{{ session.earned_points }}P</span>
            </div>
            {% endfor %}
        </div>

        {% if recent_sessions|length >= 5 %}
        <div class="text-center mt-4">
            <a href="/reading/notes/" class="text-blue-600 hover:text-blue-800 text-sm">ë” ë³´ê¸° â†’</a>
        </div>
        {% endif %}
    </div>
    {% endif %}

    <!-- Goals Card -->
    <div class="mobile-card bg-gradient-to-br from-blue-50 to-purple-50 p-4">
        <h3 class="text-lg font-bold text-gray-800 mb-3 flex items-center">
            <span class="mr-2">ğŸ¯</span>ì´ë²ˆ ì£¼ ëª©í‘œ
        </h3>
        <div class="space-y-3 text-sm">
            <div class="flex items-center">
                <div class="w-4 h-4 rounded-full bg-green-400 mr-3 flex-shrink-0"></div>
                <span>ë…ì„œ 3íšŒ ì™„ë£Œ âœ“</span>
            </div>
            <div class="flex items-center">
                <div class="w-4 h-4 rounded-full border-2 border-gray-300 mr-3 flex-shrink-0"></div>
                <span class="text-gray-600">ë…¸íŠ¸ 5ê°œ ì‘ì„±</span>
            </div>
            <div class="flex items-center">
                <div class="w-4 h-4 rounded-full border-2 border-gray-300 mr-3 flex-shrink-0"></div>
                <span class="text-gray-600">AI ë…í›„ê° 1ê°œ ìƒì„±</span>
            </div>
        </div>
    </div>

    {% else %}
    <!-- Not Authenticated - Mobile -->
    <div class="text-center py-12">
        <div class="text-6xl mb-4">ğŸŒ»</div>
        <h2 class="text-2xl font-bold text-gray-800 mb-4">ì±…ë°”ë¼ê¸°ì™€ í•¨ê»˜<br>ë…ì„œ ì—¬í–‰ì„ ì‹œì‘í•˜ì„¸ìš”!</h2>
        <p class="text-gray-600 mb-8 px-4">ì±…ì„ ì½ê³  í•´ë°”ë¼ê¸°ë¥¼ í‚¤ìš°ë©°<br>ì§€ì—­ ì¹´í˜ ì¿ í°ë„ ë°›ì•„ë³´ì„¸ìš”</p>

        <div class="space-y-3 px-4">
            <a href="/accounts/signup/" class="block w-full mobile-button bg-yellow-500 text-white py-4 rounded-2xl text-lg font-medium hover:bg-yellow-600 transition-colors">
                íšŒì›ê°€ì…í•˜ê¸°
            </a>
            <a href="/accounts/login/" class="block w-full mobile-button bg-gray-200 text-gray-800 py-4 rounded-2xl text-lg font-medium hover:bg-gray-300 transition-colors">
                ë¡œê·¸ì¸
            </a>
        </div>

        <!-- Features Preview -->
        <div class="grid grid-cols-2 gap-4 mt-8 px-4">
            <div class="mobile-card bg-white p-4 text-center">
                <div class="text-2xl mb-2">ğŸ“š</div>
                <p class="text-sm font-medium text-gray-800">ë…ì„œ ê¸°ë¡</p>
            </div>
            <div class="mobile-card bg-white p-4 text-center">
                <div class="text-2xl mb-2">ğŸŒ±</div>
                <p class="text-sm font-medium text-gray-800">í¬ì¸íŠ¸ ì ë¦½</p>
            </div>
            <div class="mobile-card bg-white p-4 text-center">
                <div class="text-2xl mb-2">â˜•</div>
                <p class="text-sm font-medium text-gray-800">ì¹´í˜ ì¿ í°</p>
            </div>
            <div class="mobile-card bg-white p-4 text-center">
                <div class="text-2xl mb-2">ğŸ¤–</div>
                <p class="text-sm font-medium text-gray-800">AI ë…í›„ê°</p>
            </div>
        </div>
    </div>
    {% endif %}

</div>

<!-- PWA-like styles for mobile -->
<style>
    @media (max-width: 640px) {
        .truncate {
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }
    }

    /* í„°ì¹˜ í”¼ë“œë°± */
    .touch-target:active {
        transform: scale(0.98);
        transition: transform 0.1s;
    }

    /* ì¹´ë“œ í˜¸ë²„ íš¨ê³¼ */
    .mobile-card:hover {
        transform: translateY(-2px);
        transition: transform 0.2s ease-out;
    }
</style>
{% endblock %}