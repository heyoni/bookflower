{% extends 'base/base.html' %}

{% block title %}λ…μ„ μ™„λ£ - {{ session.book.title }}{% endblock %}

{% block content %}
<div class="px-4 py-6 space-y-6">

    <div class="text-center">
        <div class="text-6xl mb-3">π‰</div>
        <h1 class="text-2xl font-bold text-gray-800 mb-2">λ…μ„ μ™„λ£!</h1>
        <p class="text-sm text-gray-600">μ¤λλ„ ν•΄λ°”λΌκΈ°κ°€ ν•μΈµ λ” μλμ–΄μ”</p>
    </div>

    <!-- Completion Summary -->
    <div class="mobile-card bg-white p-4">
        <div class="text-center mb-4">
            <div class="w-16 h-20 bg-yellow-100 rounded-lg flex items-center justify-center mx-auto mb-3">
                <span class="text-3xl">π“</span>
            </div>
            <h2 class="text-lg font-bold text-gray-800 truncate">{{ session.book.title }}</h2>
            <p class="text-sm text-gray-600">{{ session.book.author|default:"μ €μ λ―Έμƒ" }}</p>
        </div>

        <div class="grid grid-cols-3 gap-3 text-center">
            <div class="bg-blue-50 rounded-xl p-3">
                <div class="text-2xl mb-1">π“–</div>
                <h3 class="font-bold text-blue-800 text-sm">{{ session.pages_read }}νμ΄μ§€</h3>
                <p class="text-blue-600 text-xs">μ½μ€ νμ΄μ§€</p>
            </div>

            <div class="bg-yellow-50 rounded-xl p-3">
                <div class="text-2xl mb-1">π±</div>
                <h3 class="font-bold text-yellow-800 text-sm">+{{ session.earned_points }}P</h3>
                <p class="text-yellow-600 text-xs">νλ“ ν¬μΈνΈ</p>
            </div>

            <div class="bg-green-50 rounded-xl p-3">
                <div class="text-2xl mb-1">π“</div>
                <h3 class="font-bold text-green-800 text-sm">{{ session.book.note_set.count }}κ°</h3>
                <p class="text-green-600 text-xs">μ‘μ„±ν• λ…ΈνΈ</p>
            </div>
        </div>
    </div>

    <!-- Sunflower Growth -->
    <div class="bg-gradient-to-r from-yellow-400 to-orange-400 rounded-2xl shadow-xl p-8 mb-8 text-white">
        <div class="text-center">
            <h3 class="text-2xl font-bold mb-4">π» ν•΄λ°”λΌκΈ° μ„±μ¥ ν„ν™©</h3>

            <div class="mb-6">
                {% if user.points < 100 %}
                    <div class="text-6xl mb-2">π±</div>
                    <p class="text-xl font-medium">μƒμ‹Ή λ‹¨κ³„</p>
                    <p class="opacity-90">{{ user.points }}/100 ν¬μΈνΈ</p>
                {% elif user.points < 500 %}
                    <div class="text-6xl mb-2">πΏ</div>
                    <p class="text-xl font-medium">μ„±μ¥ λ‹¨κ³„</p>
                    <p class="opacity-90">{{ user.points }}/500 ν¬μΈνΈ</p>
                {% elif user.points < 1000 %}
                    <div class="text-6xl mb-2">π»</div>
                    <p class="text-xl font-medium">κ½ƒ λ‹¨κ³„</p>
                    <p class="opacity-90">{{ user.points }}/1000 ν¬μΈνΈ</p>
                {% else %}
                    <div class="text-6xl mb-2">π»β¨</div>
                    <p class="text-xl font-medium">λ§κ° λ‹¨κ³„</p>
                    <p class="opacity-90">{{ user.points }} ν¬μΈνΈ</p>
                {% endif %}
            </div>

            <div class="bg-white/20 rounded-full h-4 mb-4">
                {% if user.points < 100 %}
                    <div class="bg-white rounded-full h-4 transition-all duration-1000" style="width: {{ user.points }}%"></div>
                {% elif user.points < 500 %}
                    <div class="bg-white rounded-full h-4 transition-all duration-1000" style="width: {{ user.points|floatformat:0|add:0|divisibleby:5 }}%"></div>
                {% elif user.points < 1000 %}
                    <div class="bg-white rounded-full h-4 transition-all duration-1000" style="width: {{ user.points|floatformat:0|add:0|divisibleby:10 }}%"></div>
                {% else %}
                    <div class="bg-white rounded-full h-4 transition-all duration-1000" style="width: 100%"></div>
                {% endif %}
            </div>

            <p class="text-lg">μ΄ ν¬μΈνΈ: {{ user.points }}P</p>
        </div>
    </div>

    <!-- Next Actions -->
    <div class="bg-white rounded-2xl shadow-lg p-6 mb-8">
        <h3 class="text-xl font-bold text-gray-800 mb-4">λ‹¤μμ— ν•  μΌ</h3>

        <div class="grid md:grid-cols-2 gap-4">
            <a href="/reviews/create/{{ session.book.id }}/"
               class="flex items-center p-4 border-2 border-purple-200 rounded-xl hover:border-purple-400 transition-colors">
                <div class="w-12 h-12 bg-purple-100 rounded-lg flex items-center justify-center mr-4">
                    <span class="text-2xl">π¤–</span>
                </div>
                <div>
                    <h4 class="font-bold text-gray-800">AI λ…ν›„κ° μƒμ„±</h4>
                    <p class="text-sm text-gray-600">AIκ°€ λ…ν›„κ°μ„ μ‘μ„±ν•΄λ“λ ¤μ”</p>
                </div>
            </a>

            <a href="/reading/notes/"
               class="flex items-center p-4 border-2 border-blue-200 rounded-xl hover:border-blue-400 transition-colors">
                <div class="w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center mr-4">
                    <span class="text-2xl">π“</span>
                </div>
                <div>
                    <h4 class="font-bold text-gray-800">λ‚΄ λ…ΈνΈ λ³΄κΈ°</h4>
                    <p class="text-sm text-gray-600">μ§€κΈκΉμ§€ μ‘μ„±ν• λ…ΈνΈλ¥Ό ν™•μΈν•΄λ³΄μ„Έμ”</p>
                </div>
            </a>
        </div>
    </div>

    <!-- Action Buttons -->
    <div class="space-y-3">
        <a href="{% url 'reading:start' %}"
           class="block w-full mobile-button sunflower-gradient text-white py-4 rounded-xl font-medium text-center hover:opacity-90 transition-opacity">
            <span class="mr-2">π“–</span>
            λ‹¤μ‹ λ…μ„ν•κΈ°
        </a>
        <a href="{% url 'dashboard' %}"
           class="block w-full mobile-button bg-gray-200 text-gray-800 py-3 rounded-xl font-medium text-center hover:bg-gray-300 transition-colors">
            ν™μΌλ΅ κ°€κΈ°
        </a>
    </div>

    <!-- Achievements -->
    {% if session.earned_points >= 60 %}
    <div class="mt-8 bg-gradient-to-r from-green-400 to-blue-400 rounded-2xl p-6 text-white text-center">
        <div class="text-4xl mb-2">π†</div>
        <h3 class="text-xl font-bold mb-2">μ§‘μ¤‘ λ…μ„ λ‹¬μ„±!</h3>
        <p>1μ‹κ°„ μ΄μƒ μ§‘μ¤‘ν•΄μ„ λ…μ„ν•μ…¨λ„¤μ”. λ€λ‹¨ν•΄μ”!</p>
    </div>
    {% elif session.earned_points >= 30 %}
    <div class="mt-8 bg-gradient-to-r from-purple-400 to-pink-400 rounded-2xl p-6 text-white text-center">
        <div class="text-4xl mb-2">β­</div>
        <h3 class="text-xl font-bold mb-2">κΎΈμ¤€ν• λ…μ„!</h3>
        <p>30λ¶„ μ΄μƒ λ…μ„ν•μ…¨λ„¤μ”. μΆ‹μ€ μµκ΄€μ΄μ—μ”!</p>
    </div>
    {% endif %}
</div>
{% endblock %}