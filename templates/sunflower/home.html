{% extends 'base.html' %}
{% load static %}
{% block title %}홈 - 책바라기{% endblock %}

{% block content %}
<div class="sunflower-container">
    <h1>🌻 나의 해바라기 🌻</h1>

    <!-- 해바라기 성장 화면 -->
    <div class="sunflower-growth">
        <div class="sunflower" data-height="{{ sunflower.current_height_cm }}">
            <div class="height-info">
                <p>내 키는</p>
                <p>{{ sunflower.current_height_cm|floatformat:2 }}cm</p>
            </div>
            {% if sunflower.level == 1 %}
                <img src="{% static 'images/level1.jpeg' %}" alt="Level {{ sunflower.level }}">
            {% elif sunflower.level == 2 %}
                <img src="{% static 'images/level2.jpeg' %}" alt="Level {{ sunflower.level }}">
            {% elif sunflower.level == 3 %}
                <img src="{% static 'images/level3.jpeg' %}" alt="Level {{ sunflower.level }}">
            {% elif sunflower.level == 4 %}
                <img src="{% static 'images/level4.jpeg' %}" alt="Level {{ sunflower.level }}">
            {% elif sunflower.level == 5 %}
                <img src="{% static 'images/level5.webp' %}" alt="Level {{ sunflower.level }}">
            {% else %}
                <img src="{% static 'images/level1.jpeg' %}" alt="Level {{ sunflower.level }}">
            {% endif %}
            <div class="sunflower-stem"></div>
        </div>
    </div>

    <!-- 성장 통계 -->
    <div class="growth-stats">
        <h3>📊 성장 현황</h3>
        <div class="stat-item">
            <span class="stat-label">🌱 해바라기 키</span>
            <span class="stat-value">{{ sunflower.current_height_cm|floatformat:1 }}cm</span>
        </div>
        <div class="stat-item">
            <span class="stat-label">📖 총 읽은 페이지</span>
            <span class="stat-value">{{ sunflower.total_pages_read }}페이지</span>
        </div>
        <div class="stat-item">
            <span class="stat-label">⭐ 성장 단계</span>
            <span class="stat-value">{{ sunflower.level }}단계</span>
        </div>
        <div class="stat-item">
            <span class="stat-label">📚 읽고 있는 책</span>
            <span class="stat-value">{{ reading_books }}권</span>
        </div>
        <div class="stat-item">
            <span class="stat-label">✅ 완독한 책</span>
            <span class="stat-value">{{ completed_books }}권</span>
        </div>
    </div>

    <!-- 최근 읽은 책 -->
    {% if recent_books %}
    <div class="recent-books">
        <h3>📖 최근 읽은 책</h3>
        {% for item in recent_books %}
        <div class="book-card">
            <div class="book-title">{{ item.book.book_title }}</div>
            <div class="book-author">{{ item.book.book_author }}</div>
            <div class="book-progress">
                <div class="progress-bar" data-percent="{{ item.progress_percent }}">
                    <div class="progress-fill"></div>
                </div>
                <div class="progress-text">{{ item.book.current_page }}/{{ item.book.total_pages }}</div>
            </div>
            <div class="book-status">
                {% if item.book.status == 'reading' %}
                    <span style="color: #4CAF50;">📖 읽는 중</span>
                {% elif item.book.status == 'completed' %}
                    <span style="color: #2196F3;">✅ 완독</span>
                {% elif item.book.status == 'paused' %}
                    <span style="color: #FF9800;">⏸️ 일시정지</span>
                {% elif item.book.status == 'dropped' %}
                    <span style="color: #f44336;">❌ 중단</span>
                {% endif %}
            </div>
        </div>
        {% endfor %}
    </div>
    {% else %}
    <div class="empty-state">
        <h3>📚 아직 읽고 있는 책이 없어요</h3>
        <p>첫 번째 책을 추가해서 해바라기를 키워보세요!</p>
        <a href="{% url 'books:search' %}" class="btn btn-full">📖 책 찾아보기</a>
    </div>
    {% endif %}

    <!-- 성장 격려 메시지 -->
    <div class="encouragement-message">
        {% if sunflower.current_height_cm < 10 %}
            <p>🌱 해바라기가 이제 막 싹트기 시작했어요! 꾸준히 책을 읽어보세요.</p>
        {% elif sunflower.current_height_cm < 50 %}
            <p>🌿 해바라기가 쑥쑥 자라고 있어요! 계속 읽어주세요.</p>
        {% elif sunflower.current_height_cm < 100 %}
            <p>🌻 와! 해바라기가 정말 많이 자랐어요! 멋진 꽃을 피울 때가 다가왔어요.</p>
        {% else %}
            <p>🌻✨ 축하해요! 아름다운 해바라기가 완성되었어요! 정말 대단해요!</p>
        {% endif %}
    </div>
</div>

{% block extra_css %}
<style>
.recent-books {
    margin-top: 2rem;
}

.recent-books h3 {
    margin-bottom: 1rem;
    color: #333;
}

.book-status {
    margin-top: 0.5rem;
    font-size: 0.9rem;
}

.empty-state {
    text-align: center;
    padding: 2rem;
    color: #666;
}

.empty-state h3 {
    margin-bottom: 1rem;
    color: #333;
}

.encouragement-message {
    background: linear-gradient(135deg, #FFF9C4 0%, #FFF176 100%);
    border-radius: 15px;
    padding: 1.5rem;
    margin-top: 2rem;
    text-align: center;
    color: #333;
    font-weight: 500;
}
</style>

{% endblock %}
{% endblock %}