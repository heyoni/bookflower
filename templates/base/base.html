<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>{% block title %}책바라기 - Book Flower{% endblock %}</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'sunflower': {
                            100: '#fff3cd',
                            200: '#ffe69c',
                            300: '#ffda6a',
                            400: '#ffcd38',
                            500: '#ffc107',
                            600: '#e0a800',
                            700: '#b8900b',
                            800: '#8f7919',
                            900: '#66621f'
                        },
                        'leaf': {
                            100: '#d1e7dd',
                            200: '#a3cfbb',
                            300: '#75b798',
                            400: '#479f76',
                            500: '#198754',
                            600: '#146c43',
                            700: '#0f5132',
                            800: '#0a3622',
                            900: '#051b11'
                        }
                    }
                }
            }
        }
    </script>
    <style>
        .sunflower-gradient {
            background: linear-gradient(135deg, #ffc107 0%, #ffda6a 100%);
        }
        .leaf-gradient {
            background: linear-gradient(135deg, #198754 0%, #75b798 100%);
        }

        /* 모바일 전용 스타일 */
        .mobile-container {
            max-width: 100vw;
            overflow-x: hidden;
        }

        .mobile-card {
            border-radius: 16px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .mobile-button {
            min-height: 48px;
            border-radius: 12px;
            font-size: 16px;
        }

        /* 터치 친화적 버튼 */
        .touch-target {
            min-height: 44px;
            min-width: 44px;
        }

        /* 스와이프 가능한 영역 표시 */
        .swipeable {
            scroll-snap-type: x mandatory;
            scrollbar-width: none;
            -ms-overflow-style: none;
        }

        .swipeable::-webkit-scrollbar {
            display: none;
        }
    </style>
    {% block extra_head %}{% endblock %}
</head>
<body class="bg-gradient-to-br from-yellow-50 to-green-50 min-h-screen mobile-container">

    <!-- Mobile Header -->
    <header class="sunflower-gradient sticky top-0 z-50">
        <div class="px-4 py-3">
            <div class="flex items-center justify-between">
                <!-- Logo -->
                <a href="/" class="flex items-center space-x-2">
                    <div class="text-2xl">🌻</div>
                    <h1 class="text-lg font-bold text-yellow-900">책바라기</h1>
                </a>

                <!-- User Info & Menu -->
                <div class="flex items-center space-x-3">
                    {% if user.is_authenticated %}
                        <!-- Points Display -->
                        <div class="flex items-center space-x-1 bg-white/20 rounded-full px-3 py-1 text-sm">
                            <span class="text-yellow-900 font-medium">{{ user.points }}P</span>
                            <div class="text-sm">🌱</div>
                        </div>

                        <!-- Menu Button -->
                        <button onclick="toggleMobileMenu()"
                                class="touch-target flex items-center justify-center text-yellow-900 hover:bg-white/20 rounded-lg">
                            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
                            </svg>
                        </button>
                    {% else %}
                        <a href="/accounts/login/" class="mobile-button bg-white text-yellow-700 px-4 py-2 rounded-lg text-sm font-medium">
                            로그인
                        </a>
                    {% endif %}
                </div>
            </div>
        </div>

        <!-- Mobile Menu Dropdown -->
        <div id="mobileMenu" class="hidden bg-yellow-400/90 backdrop-blur-sm">
            <div class="px-4 py-3 space-y-2">
                <a href="/" class="block py-3 px-4 text-yellow-900 font-medium rounded-lg hover:bg-white/20 transition-colors">
                    🏠 홈
                </a>
                <a href="/books/search/" class="block py-3 px-4 text-yellow-900 font-medium rounded-lg hover:bg-white/20 transition-colors">
                    🔍 책 검색
                </a>
                <a href="/reading/start/" class="block py-3 px-4 text-yellow-900 font-medium rounded-lg hover:bg-white/20 transition-colors">
                    📖 독서 기록
                </a>
                <a href="/reviews/" class="block py-3 px-4 text-yellow-900 font-medium rounded-lg hover:bg-white/20 transition-colors">
                    🤖 내 독후감
                </a>
                <a href="/reading/notes/" class="block py-3 px-4 text-yellow-900 font-medium rounded-lg hover:bg-white/20 transition-colors">
                    📝 내 노트
                </a>

                {% if user.is_authenticated %}
                <div class="border-t border-white/20 pt-2 mt-2">
                    <div class="py-2 px-4 text-yellow-900">
                        <div class="text-sm opacity-80">{{ user.username }}님</div>
                    </div>
                    <a href="/accounts/logout/" class="block py-3 px-4 text-yellow-900 font-medium rounded-lg hover:bg-white/20 transition-colors">
                        🚪 로그아웃
                    </a>
                </div>
                {% endif %}
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="pb-20"> <!-- 하단 네비게이션 공간 확보 -->
        {% block content %}{% endblock %}
    </main>

    <!-- Mobile Bottom Navigation -->
    {% if user.is_authenticated %}
    <nav class="fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 z-40">
        <div class="grid grid-cols-4 h-16">
            <a href="/" class="flex flex-col items-center justify-center space-y-1 text-gray-600 hover:text-yellow-600 transition-colors touch-target">
                <div class="text-xl">🏠</div>
                <span class="text-xs">홈</span>
            </a>
            <a href="/books/search/" class="flex flex-col items-center justify-center space-y-1 text-gray-600 hover:text-blue-600 transition-colors touch-target">
                <div class="text-xl">🔍</div>
                <span class="text-xs">검색</span>
            </a>
            <a href="/reading/start/" class="flex flex-col items-center justify-center space-y-1 text-gray-600 hover:text-green-600 transition-colors touch-target">
                <div class="text-xl">📖</div>
                <span class="text-xs">기록</span>
            </a>
            <a href="/reviews/" class="flex flex-col items-center justify-center space-y-1 text-gray-600 hover:text-purple-600 transition-colors touch-target">
                <div class="text-xl">🤖</div>
                <span class="text-xs">독후감</span>
            </a>
        </div>
    </nav>
    {% endif %}

    <!-- Mobile Scripts -->
    <script>
        function toggleMobileMenu() {
            const menu = document.getElementById('mobileMenu');
            menu.classList.toggle('hidden');
        }

        // 메뉴 외부 클릭시 닫기
        document.addEventListener('click', function(event) {
            const menu = document.getElementById('mobileMenu');
            const menuButton = event.target.closest('button[onclick="toggleMobileMenu()"]');

            if (!menu.contains(event.target) && !menuButton) {
                menu.classList.add('hidden');
            }
        });

        // 뒤로가기 버튼 지원
        window.addEventListener('popstate', function(event) {
            const menu = document.getElementById('mobileMenu');
            menu.classList.add('hidden');
        });

        // 터치 스크롤 최적화
        document.addEventListener('touchstart', function() {}, { passive: true });
        document.addEventListener('touchmove', function() {}, { passive: true });
    </script>

    {% block extra_js %}{% endblock %}
</body>
</html>